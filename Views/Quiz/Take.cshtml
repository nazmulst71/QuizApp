@model List<QuizApp.Models.Question>
@{
ViewData["Title"] = "Quiz";
var attemptId = (int)ViewBag.AttemptId;
int? timeLimit = (int?)ViewBag.TimeLimitMinutes;
}
<h2>Quiz</h2>


@if (timeLimit.HasValue)
{
<div class="alert alert-info">Time left: <span id="time">@timeLimit:00</span></div>
<script>
(function(){
let min = @timeLimit;
let sec = 0;
const el = document.getElementById('time');
const t = setInterval(() => {
if (sec === 0) { if (min===0){ clearInterval(t); document.getElementById('quizForm').submit(); return; } min--; sec=59; }
else sec--;
el.textContent = `${min}:${sec.toString().padStart(2,'0')}`;
}, 1000);
})();
</script>
}


<form id="quizForm" asp-action="Submit" method="post">
@Html.AntiForgeryToken()
<input type="hidden" name="attemptId" value="@attemptId" />


@for (int i = 0; i < Model.Count; i++)
{
var q = Model[i];
<div class="card mb-3">
<div class="card-body">
<h5 class="card-title">@(i+1). @q.Text</h5>
@foreach (var opt in q.Options)
{
<div class="form-check">
<input class="form-check-input" type="radio" name="answers[@i].SelectedOptionId" value="@opt.Id" id="q@q.Id-opt@opt.Id" />
<label class="form-check-label" for="q@q.Id-opt@opt.Id">@opt.Text</label>
</div>
}
<input type="hidden" name="answers[@i].QuestionId" value="@q.Id" />
</div>
</div>
}


<button class="btn btn-primary">Submit</button>
</form>